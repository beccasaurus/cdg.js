<!DOCTYPE>
<html>
  <head>
    <title>cdg.js prototype</title>
    <script src="lib/cdg.js"></script>
  </head>
  <body>
    <input type="file" id="upload-field" />
    <pre id="debug-output"></pre>
    <script>
      // Print parsed commands to <pre> when file input is updated
      window.onload = function() {
        var uploadField = document.getElementById("upload-field");
        var debugOutput = document.getElementById("debug-output");

        uploadField.addEventListener("change", function(e) {
          var cdg = new CDG();
          var packetLimit = 2000; // only print some packets
          cdg.onPacket = function(packet) {
            if (packetLimit == 0) return;
            debugOutput.textContent = debugOutput.textContent + JSON.stringify(packet) + "\n";
            packetLimit--;
          };
          cdg.loadFile(uploadField.files[0]);
        });
      };
    </script>
  </body>
</html>
